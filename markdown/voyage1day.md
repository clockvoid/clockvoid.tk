# Voyage Group 1day internship DB

<p class="date">2018/09/16</p>

Voyage Groupのデータベースモデリングインターンに行ってきたので，その時のノートを公開しておきます．

## リレーショナル・データベース
整合性が取れる
トランザクションを使用すると，データの操作をアトミックに行える
検索が柔軟

設計をしっかりしないと後々変更したときにバグる

## ER図:データの関係を図式化したもの
Entity
Relationship
構成
* エンティティ
    * データ
* 属性
* リレーションシップ

## エンティティ
* イベント
    * 過去のある時点に発生したこと
    * 誰がいつに何に対して何をしたのか（7W2H）を考える．
    * 時間を属性として持つ
* リソース
    * イベントから参照されるもの
    * とある期間に存在し，状態が変わっていく

## モデリングの手段
エンティティ抽出
属性洗い出し
どんなデータを保持するか
正規化
リレーションを貼る
主キーを決める

### 属性を洗い出す
リソースからやっていったほうがやりやすい

（例）
* 学生
    * 名前
    * 学校名
    * 好きな言語
    →リソースにしたほうが良さそう

* インターン
    * インターン名
    * 会社名

* 参加記録
    * 学生
    * インターン名
    * 感想
    * 出欠

etc...

## リレーションシップを作る
記号とカーディナリティとオプショなリティが大事！
オプショナリティは必須（1）か任意（◯）か
カーディナリティは1件に対応（1）するか多数に対応する（鳥足）か

## 主キーを定義する
* 自然キー
* 代理キー（システム側でユニークな番号を発番する）→論理モデルの中では絶対に使用しない！（破綻するため）

## マイグレーション
マイグレーションと言う単語が初めて出てきたのは，2003年ごろ．

実際の開発リリース
* リリース
    * できるだけ小さくすばやく
    * 一日に何度もリリースする．
    * 失敗したときにリスクを小さく，失敗したら戻せる状態をなるべく実現する．

* CI
    * Pushしたら自動でビルド，テスト
    * 何回環境を再構築しても同じ環境ができるようにする

* 開発中
    * ある時点のコードをチェックアウトして構築したら，アプリケーションもデータベースも同じように管理したい

* しゅるい
    * DSL型:フレームワークに付属しているもの
    * SQL型:独立したツールとして使えるもの
    →今回はGolangのsql-migrate
